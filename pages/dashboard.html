<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Dashboard - HyperMind AI</title>
   <script src="https://cdn.tailwindcss.com"></script>
   <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>   
   <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
   <style>
       .hyperion-glow {
           animation: hyperionPulse 2s ease-in-out infinite;
       }
       @keyframes hyperionPulse {
           0%, 100% { box-shadow: 0 0 20px rgba(139, 92, 246, 0.3); }
           50% { box-shadow: 0 0 30px rgba(139, 92, 246, 0.5); }
       }
       .ai-brain-animation {
           animation: brainPulse 1.5s ease-in-out infinite;
       }
       @keyframes brainPulse {
           0%, 100% { opacity: 0.8; filter: brightness(1); }
           50% { opacity: 1; filter: brightness(1.2); }
       }
       .glass-card {
           background: rgba(17, 24, 39, 0.8);
           backdrop-filter: blur(16px);
           border: 1px solid rgba(255, 255, 255, 0.1);
       }
       .glass-nav {
           background: rgba(17, 24, 39, 0.95);
           backdrop-filter: blur(20px);
           border-bottom: 1px solid rgba(255, 255, 255, 0.1);
       }
       .text-gradient {
           background: linear-gradient(135deg, #8b5cf6, #3b82f6);
           -webkit-background-clip: text;
           -webkit-text-fill-color: transparent;
           background-clip: text;
       }
       .hover-lift {
           transition: transform 0.3s ease;
       }
       .hover-lift:hover {
           transform: translateY(-2px);
       }
       .pulse-dot {
           animation: pulse 2s infinite;
       }
       .animate-float {
           animation: float 3s ease-in-out infinite;
       }
       @keyframes float {
           0%, 100% { transform: translateY(0px); }
           50% { transform: translateY(-10px); }
       }
       .glow-purple {
           box-shadow: 0 0 20px rgba(139, 92, 246, 0.3);
       }
       .glow-green {
           box-shadow: 0 0 20px rgba(34, 197, 94, 0.3);
       }
       .glow-blue {
           box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
       }
       .glow-yellow {
           box-shadow: 0 0 20px rgba(251, 191, 36, 0.3);
       }
       .glow-red {
           box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);
       }
       .chart-container {
           position: relative;
           height: 300px;
       }
       .btn-primary {
           background: linear-gradient(135deg, #8b5cf6, #3b82f6);
           color: white;
           border: none;
           transition: all 0.3s ease;
       }
       .btn-primary:hover {
           transform: translateY(-2px);
           box-shadow: 0 10px 25px rgba(139, 92, 246, 0.4);
       }
       .btn-secondary {
           background: rgba(55, 65, 81, 0.8);
           color: #d1d5db;
           border: 1px solid rgba(255, 255, 255, 0.1);
           transition: all 0.3s ease;
       }
       .btn-secondary:hover {
           background: rgba(75, 85, 99, 0.8);
           color: white;
       }
       .btn-danger {
           background: linear-gradient(135deg, #ef4444, #dc2626);
           color: white;
           border: none;
           transition: all 0.3s ease;
       }
       .btn-danger:hover {
           transform: translateY(-2px);
           box-shadow: 0 10px 25px rgba(239, 68, 68, 0.4);
       }
       .nav-item {
           color: #9ca3af;
           transition: all 0.3s ease;
       }
       .nav-item:hover {
           color: white;
           background: rgba(139, 92, 246, 0.2);
       }
       .nav-item.active {
           color: white;
           background: linear-gradient(135deg, #8b5cf6, #3b82f6);
       }
       .sidebar {
           background: rgba(17, 24, 39, 0.95);
           backdrop-filter: blur(20px);
       }
       .loading-bar {
           background: linear-gradient(90deg, #8b5cf6, #3b82f6);
           animation: loading 2s ease-in-out infinite;
       }
       @keyframes loading {
           0%, 100% { opacity: 0.6; }
           50% { opacity: 1; }
       }
       .neural-pulse {
           animation: neural-pulse 2s ease-in-out infinite;
       }
       @keyframes neural-pulse {
           0%, 100% { 
               transform: scale(1);
               box-shadow: 0 0 0 0 rgba(139, 92, 246, 0.7);
           }
           50% { 
               transform: scale(1.05);
               box-shadow: 0 0 0 10px rgba(139, 92, 246, 0);
           }
       }
       .market-ticker {
           background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.1), transparent);
           animation: ticker-move 30s linear infinite;
       }
       @keyframes ticker-move {
           0% { transform: translateX(100%); }
           100% { transform: translateX(-100%); }
       }
       .risk-meter {
           background: conic-gradient(from 0deg, #10b981 0deg 120deg, #f59e0b 120deg 240deg, #ef4444 240deg 360deg);
           border-radius: 50%;
           position: relative;
       }
       .risk-needle {
           position: absolute;
           top: 50%;
           left: 50%;
           width: 3px;
           height: 40%;
           background: white;
           transform-origin: bottom center;
           transform: translate(-50%, -100%) rotate(60deg);
           border-radius: 2px;
       }
       .execute-btn {
           background: linear-gradient(135deg, #10b981, #059669);
           color: white;
           border: none;
           padding: 6px 12px;
           border-radius: 6px;
           font-size: 12px;
           font-weight: 600;
           transition: all 0.3s ease;
           cursor: pointer;
       }
       .execute-btn:hover {
           transform: translateY(-1px);
           box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
       }
       .execute-btn:disabled {
           opacity: 0.6;
           cursor: not-allowed;
       }
       .notification {
           position: fixed;
           top: 20px;
           right: 20px;
           padding: 16px 24px;
           border-radius: 8px;
           color: white;
           font-weight: 600;
           z-index: 1000;
           max-width: 400px;
           box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
           animation: slideIn 0.3s ease-out;
       }
       .notification.success {
           background: linear-gradient(135deg, #10b981, #059669);
       }
       .notification.error {
           background: linear-gradient(135deg, #ef4444, #dc2626);
       }
       .notification.info {
           background: linear-gradient(135deg, #3b82f6, #2563eb);
       }
       @keyframes slideIn {
           from {
               transform: translateX(100%);
               opacity: 0;
           }
           to {
               transform: translateX(0);
               opacity: 1;
           }
       }
       .wallet-status {
           transition: all 0.3s ease;
       }
       .wallet-status.connected {
           background: linear-gradient(135deg, #10b981, #059669);
       }
       .wallet-status.disconnected {
           background: linear-gradient(135deg, #667eea, #764ba2);
       }
   </style>
</head>
<body class="bg-black text-white min-h-screen">
   <!-- Header -->
   <header class="glass-nav fixed w-full top-0 z-50 p-4">
       <div class="flex justify-between items-center">
           <!-- Logo & Title -->
           <div class="flex items-center space-x-4">
              <a href="../index.html" class="flex items-center space-x-3 hover-lift">
                 <div class="w-10 h-10 bg-gradient-to-r from-purple-500 to-blue-500 rounded-xl flex items-center justify-center hyperion-glow">
                     <i data-lucide="brain" class="w-5 h-5 text-white ai-brain-animation"></i>
                 </div>
                 <div>
                     <h1 class="text-xl font-bold text-gradient">HyperMind AI</h1>
                     <p class="text-sm text-purple-400">Powered by Hyperion Alith</p>
                 </div>
              </a>
           </div>           
           
           <!-- Navigation -->
           <div class="hidden md:flex items-center space-x-6">
               <a href="dashboard.html" class="text-purple-400 font-semibold">Dashboard</a>
               <a href="signals.html" class="text-gray-300 hover:text-white transition-colors">AI Signals</a>
               <a href="portfolio.html" class="text-gray-300 hover:text-white transition-colors">Portfolio</a>
               <a href="login.html" class="text-gray-300 hover:text-white transition-colors">
                   <i data-lucide="user" class="w-4 h-4 inline mr-1"></i>Account
               </a>
           </div>
           
           <!-- Status & Portfolio -->
           <div class="flex items-center space-x-6">
               <!-- AI Status -->
               <div class="glass-card px-4 py-2 rounded-xl glow-green">
                   <div class="flex items-center space-x-2">
                       <div class="w-3 h-3 bg-green-500 rounded-full pulse-dot"></div>
                       <span class="text-sm font-semibold text-green-400">Alith AI: ACTIVE</span>
                   </div>
               </div>
               
               <!-- Wallet Status -->
               <button id="connect-wallet-btn" class="wallet-status disconnected px-4 py-2 rounded-xl font-semibold text-sm">
                   Connect Wallet
               </button>
               
               <!-- Portfolio Value -->
               <div class="text-right">
                   <div class="text-sm text-gray-400">Total Portfolio</div>
                   <div class="text-2xl font-bold text-gradient" id="portfolio-value">$127,834.92</div>
                   <div class="text-sm text-green-400 flex items-center justify-end">
                       <i data-lucide="trending-up" class="w-3 h-3 mr-1"></i>
                       <span id="portfolio-change">+$8,247.35 (6.89%)</span>
                   </div>
               </div>
           </div>
       </div>
   </header>

   <!-- Market Ticker -->
   <div class="fixed top-20 w-full bg-black/50 border-y border-purple-500/20 py-1 z-40 overflow-hidden">
       <div class="market-ticker whitespace-nowrap">
           <span class="text-green-400 mx-8">ETH/USDC: +8.24% | AI CONFIDENCE: 97.3%</span>
           <span class="text-blue-400 mx-8">BTC/USDT: +4.67% | NEURAL PROCESSING: 11.2k/s</span>
           <span class="text-purple-400 mx-8">TOTAL PROFIT: +$8,247.35 | ALITH STATUS: ACTIVE</span>
           <span class="text-yellow-400 mx-8">RISK LEVEL: OPTIMIZED | WIN RATE: 94.7%</span>
       </div>
   </div>

   <div class="flex pt-24">
       <!-- Sidebar -->
       <aside class="sidebar w-64 min-h-screen p-6 border-r border-white/10">
           <nav class="space-y-3">
               <a href="dashboard.html" class="nav-item active flex items-center space-x-3 px-4 py-3 rounded-xl font-semibold">
                   <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
                   <span>Dashboard</span>
               </a>
               <a href="signals.html" class="nav-item flex items-center space-x-3 px-4 py-3 rounded-xl">
                   <i data-lucide="trending-up" class="w-5 h-5"></i>
                   <span>AI Signals</span>
               </a>
               <a href="portfolio.html" class="nav-item flex items-center space-x-3 px-4 py-3 rounded-xl">
                   <i data-lucide="wallet" class="w-5 h-5"></i>
                   <span>Portfolio</span>
               </a>
               <a href="../index.html" class="nav-item flex items-center space-x-3 px-4 py-3 rounded-xl">
                   <i data-lucide="home" class="w-5 h-5"></i>
                   <span>Home</span>
               </a>
               <a href="login.html" class="nav-item flex items-center space-x-3 px-4 py-3 rounded-xl">
                   <i data-lucide="user" class="w-5 h-5"></i>
                   <span>Account</span>
               </a>
           </nav>
           
           <!-- Quick Actions -->
           <div class="mt-8 space-y-3">
               <h3 class="text-sm font-semibold text-gray-400 uppercase tracking-wider mb-4">Neural Commands</h3>
               <button class="w-full btn-primary py-3 rounded-xl font-semibold hover-lift glow-purple" id="execute-all-btn">
                   <i data-lucide="zap" class="w-4 h-4 inline mr-2"></i>
                   Execute All Signals
               </button>
               <button class="w-full btn-danger py-3 rounded-xl font-semibold hover-lift" id="emergency-btn">
                   <i data-lucide="shield-alert" class="w-4 h-4 inline mr-2"></i>
                   Emergency Stop
               </button>
               <button class="w-full btn-secondary py-3 rounded-xl font-semibold hover-lift" id="rebalance-btn">
                   <i data-lucide="refresh-cw" class="w-4 h-4 inline mr-2"></i>
                   Auto Rebalance
               </button>
           </div>

           <!-- AI Status Panel -->
           <div class="mt-8 glass-card p-4 rounded-xl">
               <h3 class="text-sm font-semibold text-gray-400 uppercase tracking-wider mb-3">Hyperion Alith Status</h3>
               <div class="space-y-3">
                   <div class="flex justify-between items-center">
                       <span class="text-sm text-gray-300">Neural Processing</span>
                       <span class="text-sm text-green-400 font-semibold" id="ai-processing-count">11.2k/sec</span>
                   </div>
                   <div class="flex justify-between items-center">
                       <span class="text-sm text-gray-300">Confidence Level</span>
                       <span class="text-sm text-purple-400 font-semibold" id="ai-confidence">95.5%</span>
                   </div>
                   <div class="flex justify-between items-center">
                       <span class="text-sm text-gray-300">Network Uptime</span>
                       <span class="text-sm text-blue-400 font-semibold">99.96%</span>
                   </div>
               </div>
           </div>
       </aside>

       <!-- Main Content -->
       <main class="flex-1 p-6 space-y-6">
           <!-- Top Stats Row -->
           <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
               <!-- Performance Card -->
               <div class="glass-card p-6 hover-lift glow-green">
                   <div class="flex justify-between items-start mb-4">
                       <div>
                           <p class="text-gray-400 text-sm font-medium">24h Performance</p>
                           <p class="text-3xl font-bold text-green-400" id="daily-performance">+$8,247</p>
                           <p class="text-green-400 text-sm flex items-center mt-1">
                               <i data-lucide="trending-up" class="w-3 h-3 mr-1"></i>
                               <span id="daily-percentage">+6.89% (+$2.3k AI)</span>
                           </p>
                       </div>
                       <div class="glass-card glow-green p-3 rounded-xl pulse-dot">
                           <i data-lucide="trending-up" class="w-6 h-6 text-green-500"></i>
                       </div>
                   </div>
                   <div class="w-full bg-gray-800 rounded-full h-2">
                       <div class="loading-bar h-2 rounded-full w-3/4"></div>
                   </div>
               </div>
               
               <!-- Active Trades Card -->
               <div class="glass-card p-6 hover-lift glow-blue">
                   <div class="flex justify-between items-start mb-4">
                       <div>
                           <p class="text-gray-400 text-sm font-medium">Active AI Trades</p>
                           <p class="text-3xl font-bold text-blue-400" id="active-trades">17</p>
                           <p class="text-blue-400 text-sm flex items-center mt-1">
                               <i data-lucide="brain" class="w-3 h-3 mr-1"></i>
                               <span id="profitable-trades">14 Profitable</span>
                           </p>
                       </div>
                       <div class="glass-card glow-blue p-3 rounded-xl pulse-dot">
                           <i data-lucide="activity" class="w-6 h-6 text-blue-500"></i>
                       </div>
                   </div>
                   <div class="flex space-x-2">
                       <div class="w-3 h-3 bg-green-500 rounded-full pulse-dot"></div>
                       <div class="w-3 h-3 bg-green-500 rounded-full pulse-dot" style="animation-delay: 0.2s;"></div>
                       <div class="w-3 h-3 bg-blue-500 rounded-full pulse-dot" style="animation-delay: 0.4s;"></div>
                       <div class="w-3 h-3 bg-red-500 rounded-full pulse-dot" style="animation-delay: 0.6s;"></div>
                   </div>
               </div>
               
               <!-- Win Rate Card -->
               <div class="glass-card p-6 hover-lift glow-purple">
                   <div class="flex justify-between items-start mb-4">
                       <div>
                           <p class="text-gray-400 text-sm font-medium">AI Win Rate</p>
                           <p class="text-3xl font-bold text-purple-400" id="win-rate">94.7%</p>
                           <p class="text-purple-400 text-sm flex items-center mt-1">
                               <i data-lucide="target" class="w-3 h-3 mr-1"></i>
                               This Month
                           </p>
                       </div>
                       <div class="glass-card glow-purple p-3 rounded-xl pulse-dot">
                           <i data-lucide="target" class="w-6 h-6 text-purple-500"></i>
                       </div>
                   </div>
                   <div class="text-xs text-gray-400">Hyperion Alith Intelligence</div>
               </div>
               
               <!-- Risk Level Card -->
               <div class="glass-card p-6 hover-lift glow-yellow">
                   <div class="flex justify-between items-start mb-4">
                       <div>
                           <p class="text-gray-400 text-sm font-medium">Risk Level</p>
                           <p class="text-3xl font-bold text-yellow-400" id="risk-level">Medium</p>
                           <p class="text-yellow-400 text-sm flex items-center mt-1">
                               <i data-lucide="shield" class="w-3 h-3 mr-1"></i>
                               AI Optimized
                           </p>
                       </div>
                       <div class="relative w-12 h-12">
                           <div class="risk-meter w-12 h-12">
                               <div class="risk-needle"></div>
                           </div>
                       </div>
                   </div>
                   <div class="text-xs text-gray-400">Auto-adjusted by AI</div>
               </div>
           </div>

           <!-- Main Dashboard Grid -->
           <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
               <!-- Live Signals Preview -->
               <div class="lg:col-span-2 glass-card p-6 hover-lift">
                   <div class="flex justify-between items-center mb-6">
                       <div>
                           <h2 class="text-2xl font-bold text-gradient">Live AI Signals</h2>
                           <p class="text-sm text-gray-400">Real-time analysis by Hyperion Alith</p>
                       </div>
                       <div class="flex items-center space-x-3">
                           <div class="glass-card px-3 py-1 rounded-full glow-green">
                               <div class="flex items-center space-x-2">
                                   <div class="w-2 h-2 bg-green-500 rounded-full pulse-dot"></div>
                                   <span class="text-xs text-green-400 font-semibold">ANALYZING</span>
                               </div>
                           </div>
                           <a href="signals.html" class="btn-secondary px-4 py-2 rounded-lg text-sm hover-lift">
                               View All
                           </a>
                       </div>
                   </div>
                   
                   <!-- Signal Cards Container -->
                   <div class="space-y-4" id="dashboard-signals">
                       <!-- Signals will be populated by JavaScript -->
                   </div>
               </div>

               <!-- Right Column -->
               <div class="space-y-6">
                   <!-- Portfolio Overview -->
                   <div class="glass-card p-6 hover-lift">
                       <div class="flex justify-between items-center mb-4">
                           <h3 class="text-lg font-bold text-gradient">Portfolio Overview</h3>
                           <a href="portfolio.html" class="btn-secondary px-3 py-1 rounded-lg text-xs hover-lift">
                               Details
                           </a>
                       </div>
                       <div class="space-y-3" id="portfolio-overview">
                           <div class="flex justify-between items-center">
                               <div class="flex items-center space-x-3">
                                   <div class="w-8 h-8 bg-gradient-to-r from-orange-500 to-yellow-500 rounded-full flex items-center justify-center">
                                       <span class="text-white font-bold text-xs">BT</span>
                                   </div>
                                   <div>
                                       <div class="font-semibold text-white text-sm">Bitcoin</div>
                                       <div class="text-xs text-gray-400">31.7%</div>
                                   </div>
                               </div>
                               <div class="text-right">
                                   <div class="text-sm text-green-400 font-semibold">+8.23%</div>
                               </div>
                           </div>
                           
                           <div class="flex justify-between items-center">
                               <div class="flex items-center space-x-3">
                                   <div class="w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center">
                                       <span class="text-white font-bold text-xs">OT</span>
                                   </div>
                                   <div>
                                       <div class="font-semibold text-white text-sm">Other Assets</div>
                                       <div class="text-xs text-gray-400">26.0%</div>
                                   </div>
                               </div>
                               <div class="text-right">
                                   <div class="text-sm text-green-400 font-semibold">+5.12%</div>
                               </div>
                           </div>
                       </div>
                   </div>
                   
                   <!-- AI Insights -->
                   <div class="glass-card p-6 hover-lift">
                       <h3 class="text-lg font-bold mb-4 text-gradient">AI Insights</h3>
                       <div class="space-y-3" id="ai-insights-dashboard">
                           <div class="glass-card border border-purple-500/30 p-3 hover-lift">
                               <div class="flex items-start space-x-2">
                                   <i data-lucide="brain" class="w-4 h-4 text-purple-400 mt-1 pulse-dot"></i>
                                   <div>
                                       <div class="text-sm font-semibold text-purple-400">Pattern Detected</div>
                                       <div class="text-xs text-gray-300">Bull flag on ETH/USDC with 89% success rate</div>
                                   </div>
                               </div>
                           </div>
                           
                           <div class="glass-card border border-yellow-500/30 p-3 hover-lift">
                               <div class="flex items-start space-x-2">
                                   <i data-lucide="alert-circle" class="w-4 h-4 text-yellow-400 mt-1 animate-float"></i>
                                   <div>
                                       <div class="text-sm font-semibold text-yellow-400">Market Alert</div>
                                       <div class="text-xs text-gray-300">Increased volatility expected. Adjust positions.</div>
                                   </div>
                               </div>
                           </div>
                           
                           <div class="glass-card border border-blue-500/30 p-3 hover-lift">
                               <div class="flex items-start space-x-2">
                                   <i data-lucide="zap" class="w-4 h-4 text-blue-400 mt-1 pulse-dot"></i>
                                   <div>
                                       <div class="text-sm font-semibold text-blue-400">AI Recommendation</div>
                                       <div class="text-xs text-gray-300">Portfolio rebalancing suggested in 2h</div>
                                   </div>
                               </div>
                           </div>
                       </div>
                   </div>
               </div>
           </div>
       </main>
   </div>

   <!-- Web3 Configuration -->
   <script>
       // Hyperion Testnet Configuration
       const HYPERION_TESTNET_CONFIG = {
           chainId: '0x20A55',
           chainName: 'Hyperion Testnet',
           nativeCurrency: {
               name: 'tMETIS',
               symbol: 'tMETIS',
               decimals: 18
           },
           rpcUrls: ['https://testnet-rpc.hyperion.network'],
           blockExplorerUrls: ['https://testnet-explorer.hyperion.network']
       };

       const CONTRACT_ADDRESS = '0x4bF9Ff46CD70D7A28169bC028A822Df95bF4A049';
       const CONTRACT_ABI = [
           "function createSignal(string pair, string signalType, uint256 entryPrice, uint256 targetPrice, uint256 stopLoss, uint256 confidence) external",
           "function executeSignal(uint256 signalId) external",
           "function getSignalCount() external view returns (uint256)",
           "event SignalCreated(uint256 indexed signalId, address indexed trader, string pair, string signalType)"
       ];

       // =========================================
       // Wallet Connection Class
       // =========================================
       class WalletConnection {
           constructor() {
               this.provider = null;
               this.signer = null;
               this.contract = null;
               this.userAddress = null;
               this.isConnected = false;
           }

           async connectWallet() {
               try {
                   if (!window.ethereum) {
                       throw new Error('MetaMask not detected. Please install MetaMask.');
                   }

                   const accounts = await window.ethereum.request({
                       method: 'eth_requestAccounts'
                   });

                   if (accounts.length === 0) {
                       throw new Error('No accounts found. Please connect your wallet.');
                   }

                   // Add/Switch to Hyperion Testnet
                   try {
                       await window.ethereum.request({
                           method: 'wallet_switchEthereumChain',
                           params: [{ chainId: HYPERION_TESTNET_CONFIG.chainId }]
                       });
                   } catch (switchError) {
                       if (switchError.code === 4902) {
                           await window.ethereum.request({
                               method: 'wallet_addEthereumChain',
                               params: [HYPERION_TESTNET_CONFIG]
                           });
                       } else {
                           throw switchError;
                       }
                   }

                   this.provider = new ethers.providers.Web3Provider(window.ethereum);
                   this.signer = this.provider.getSigner();
                   this.userAddress = accounts[0];
                   this.isConnected = true;
                   this.contract = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, this.signer);

                   console.log('🚀 Wallet connected successfully:', this.userAddress);
                   this.updateUI();
                   
                   return {
                       success: true,
                       address: this.userAddress,
                       contractAddress: CONTRACT_ADDRESS
                   };

               } catch (error) {
                   console.error('❌ Wallet connection failed:', error);
                   return {
                       success: false,
                       error: error.message
                   };
               }
           }

           updateUI() {
               const connectButton = document.getElementById('connect-wallet-btn');
               
               if (this.isConnected) {
                   if (connectButton) {
                       connectButton.textContent = `Connected: ${this.userAddress.slice(0, 6)}...${this.userAddress.slice(-4)}`;
                       connectButton.className = connectButton.className.replace('disconnected', 'connected');
                   }
               } else {
                   if (connectButton) {
                       connectButton.textContent = 'Connect Wallet';
                       connectButton.className = connectButton.className.replace('connected', 'disconnected');
                   }
               }
           }

           async createSignal(signalData) {
               if (!this.isConnected || !this.contract) {
                   throw new Error('Wallet not connected');
               }

               try {
                   console.log('🤖 Creating signal on-chain:', signalData);

                   const entryPrice = ethers.utils.parseEther(signalData.entryPrice.toString());
                   const targetPrice = ethers.utils.parseEther(signalData.targetPrice.toString());
                   const stopLoss = ethers.utils.parseEther(signalData.stopLoss.toString());

                   const tx = await this.contract.createSignal(
                       signalData.pair,
                       signalData.signalType,
                       entryPrice,
                       targetPrice,
                       stopLoss,
                       signalData.confidence
                   );

                   console.log('📋 Transaction sent:', tx.hash);
                   const receipt = await tx.wait();
                   console.log('✅ Signal created successfully:', receipt);

                   return {
                       success: true,
                       txHash: tx.hash,
                       blockNumber: receipt.blockNumber
                   };

               } catch (error) {
                   console.error('❌ Transaction failed:', error);
                   return {
                       success: false,
                       error: error.message
                   };
               }
           }

           async executeSignal(signalId) {
               if (!this.isConnected || !this.contract) {
                   throw new Error('Wallet not connected');
               }

               try {
                   console.log('⚡ Executing signal:', signalId);
                   
                   const tx = await this.contract.executeSignal(signalId);
                   console.log('📋 Execution transaction sent:', tx.hash);
                   
                   const receipt = await tx.wait();
                   console.log('✅ Signal executed successfully:', receipt);

                   return {
                       success: true,
                       txHash: tx.hash,
                       blockNumber: receipt.blockNumber
                   };

               } catch (error) {
                   console.error('❌ Execution failed:', error);
                   return {
                       success: false,
                       error: error.message
                   };
               }
           }
       }

       // =========================================
       // AI Signal Generator (Mock)
       // =========================================
       class AlithMock {
           static generateSignal() {
               const pairs = ['ETH/USDC', 'BTC/USDT', 'MATIC/USDC', 'LINK/ETH', 'AVAX/USDT', 'UNI/ETH'];
               const types = ['STRONG_BUY', 'BUY', 'MONITOR', 'HOLD'];
               const pair = pairs[Math.floor(Math.random() * pairs.length)];
               const signalType = types[Math.floor(Math.random() * types.length)];
               const basePrice = Math.random() * 3000 + 1000;
               const confidence = Math.floor(Math.random() * 30) + 70; // 70-100%
               
               return {
                   id: Date.now() + Math.random(),
                   pair: pair,
                   signalType: signalType,
                   entryPrice: Number(basePrice.toFixed(2)),
                   targetPrice: Number((basePrice * (1 + Math.random() * 0.15)).toFixed(2)),
                   stopLoss: Number((basePrice * (0.85 + Math.random() * 0.1)).toFixed(2)),
                   confidence: confidence,
                   analysis: `AI Analysis: ${signalType} signal detected with ${confidence}% confidence`,
                   timestamp: Date.now(),
                   executed: false
               };
           }

           static startSignalGeneration(callback, interval = 15000) {
               callback(this.generateSignal());
               return setInterval(() => {
                   callback(this.generateSignal());
               }, interval);
           }
       }

       // =========================================
       // Main Application
       // =========================================
       class HyperMindApp {
           constructor() {
               this.wallet = new WalletConnection();
               this.signalInterval = null;
               this.signals = [];
           }

           async init() {
               console.log('🚀 Initializing HyperMind AI...');
               
               this.setupEventListeners();
               this.startSignalGeneration();
               this.startRealtimeUpdates();
               
               console.log('✅ HyperMind AI initialized');
           }

           setupEventListeners() {
               const connectBtn = document.getElementById('connect-wallet-btn');
               if (connectBtn) {
                   connectBtn.addEventListener('click', () => this.connectWallet());
               }

               const executeAllBtn = document.getElementById('execute-all-btn');
               if (executeAllBtn) {
                   executeAllBtn.addEventListener('click', () => this.executeAllSignals());
               }

               // Event delegation for dynamic execute buttons
               document.addEventListener('click', (e) => {
                   if (e.target.classList.contains('execute-signal-btn') || 
                       e.target.closest('.execute-signal-btn')) {
                       const btn = e.target.classList.contains('execute-signal-btn') ? 
                                  e.target : e.target.closest('.execute-signal-btn');
                       const signalId = btn.dataset.signalId;
                       this.executeSignal(signalId);
                   }
               });
           }

           async connectWallet() {
               const result = await this.wallet.connectWallet();
               
               if (result.success) {
                   this.showNotification('✅ Wallet connected to Hyperion!', 'success');
               } else {
                   this.showNotification(`❌ Connection failed: ${result.error}`, 'error');
               }
           }

           startSignalGeneration() {
               this.signalInterval = AlithMock.startSignalGeneration((signal) => {
                   this.handleNewSignal(signal);
               });
           }

           async handleNewSignal(signal) {
               console.log('🤖 New AI signal:', signal);
               
               // Auto-create high confidence signals on-chain
               if (this.wallet.isConnected && signal.confidence > 85) {
                   try {
                       const result = await this.wallet.createSignal(signal);
                       if (result.success) {
                           signal.onChain = true;
                           signal.txHash = result.txHash;
                           this.showNotification('📊 High-confidence signal created on-chain!', 'success');
                       }
                   } catch (error) {
                       console.error('Failed to create on-chain signal:', error);
                   }
               }
               
               this.signals.unshift(signal);
               if (this.signals.length > 10) {
                   this.signals.pop();
               }
               
               this.updateSignalsDisplay();
           }

           updateSignalsDisplay() {
               const container = document.getElementById('dashboard-signals');
               if (!container) return;

               const signalsToShow = this.signals.slice(0, 3); // Show top 3 signals
               
               container.innerHTML = signalsToShow.map(signal => {
                   const colorClass = this.getSignalColorClass(signal.signalType);
                   const iconName = this.getSignalIcon(signal.signalType);
                   const percentage = ((signal.targetPrice - signal.entryPrice) / signal.entryPrice * 100).toFixed(1);
                   
                   return `
                       <div class="glass-card border border-${colorClass}-500/30 p-4 hover-lift glow-${colorClass}">
                           <div class="flex justify-between items-center mb-3">
                               <div class="flex items-center space-x-3">
                                   <div class="w-10 h-10 bg-${colorClass}-500 rounded-xl flex items-center justify-center">
                                       <i data-lucide="${iconName}" class="w-5 h-5 text-white"></i>
                                   </div>
                                   <div>
                                       <h3 class="font-bold text-${colorClass}-400">${signal.signalType}</h3>
                                       <p class="text-sm text-gray-400">${signal.pair} • AI Generated</p>
                                   </div>
                               </div>
                               <div class="flex items-center space-x-3">
                                   <div class="text-right">
                                       <div class="text-xl font-bold text-${colorClass}-400">${percentage > 0 ? '+' : ''}${percentage}%</div>
                                       <div class="text-xs text-gray-400">${signal.confidence}% confidence</div>
                                   </div>
                                   <button class="execute-signal-btn execute-btn" data-signal-id="${signal.id}">
                                       Execute
                                   </button>
                               </div>
                           </div>
                           <div class="text-xs text-gray-300 mb-2">
                               Entry: ${signal.entryPrice} | Target: ${signal.targetPrice} | Stop: ${signal.stopLoss}
                           </div>
                           <div class="text-xs text-${colorClass}-300">
                               ${signal.analysis}
                           </div>
                           ${signal.onChain ? `
                               <div class="mt-2 flex items-center space-x-2">
                                   <div class="w-2 h-2 bg-green-500 rounded-full pulse-dot"></div>
                                   <span class="text-xs text-green-400">On-chain • TX: ${signal.txHash?.slice(0, 10)}...</span>
                               </div>
                           ` : ''}
                       </div>
                   `;
               }).join('');

               // Re-initialize Lucide icons for the new content
               if (typeof lucide !== 'undefined') {
                   lucide.createIcons();
               }
           }

           getSignalColorClass(signalType) {
               switch (signalType) {
                   case 'STRONG_BUY': return 'green';
                   case 'BUY': return 'purple';
                   case 'MONITOR': return 'blue';
                   case 'HOLD': return 'yellow';
                   default: return 'gray';
               }
           }

           getSignalIcon(signalType) {
               switch (signalType) {
                   case 'STRONG_BUY': return 'trending-up';
                   case 'BUY': return 'zap';
                   case 'MONITOR': return 'eye';
                   case 'HOLD': return 'hand';
                   default: return 'activity';
               }
           }

           async executeSignal(signalId) {
               if (!this.wallet.isConnected) {
                   this.showNotification('❌ Please connect wallet first', 'error');
                   return;
               }

               const signal = this.signals.find(s => s.id == signalId);
               if (!signal) {
                   this.showNotification('❌ Signal not found', 'error');
                   return;
               }

               const btn = document.querySelector(`[data-signal-id="${signalId}"]`);
               if (btn) {
                   btn.disabled = true;
                   btn.textContent = 'Executing...';
               }

               try {
                   const result = await this.wallet.createSignal(signal);
                   
                   if (result.success) {
                       signal.executed = true;
                       signal.txHash = result.txHash;
                       this.showNotification('✅ Signal executed successfully!', 'success');
                       
                       if (btn) {
                           btn.textContent = 'Executed ✅';
                           btn.style.background = 'linear-gradient(135deg, #10b981, #059669)';
                       }
                   } else {
                       this.showNotification(`❌ Execution failed: ${result.error}`, 'error');
                       if (btn) {
                           btn.disabled = false;
                           btn.textContent = 'Execute';
                       }
                   }
                   
               } catch (error) {
                   console.error('Execute signal error:', error);
                   this.showNotification('❌ Transaction failed', 'error');
                   if (btn) {
                       btn.disabled = false;
                       btn.textContent = 'Execute';
                   }
               }
           }

           async executeAllSignals() {
               if (!this.wallet.isConnected) {
                   this.showNotification('❌ Please connect wallet first', 'error');
                   return;
               }

               const btn = document.getElementById('execute-all-btn');
               if (btn) {
                   btn.disabled = true;
                   btn.innerHTML = '<i data-lucide="loader" class="w-4 h-4 inline mr-2 animate-spin"></i>Processing...';
                   
                   try {
                       let executed = 0;
                       for (let signal of this.signals) {
                           if (signal.confidence > 85 && !signal.executed) {
                               await this.wallet.createSignal(signal);
                               executed++;
                               signal.executed = true;
                               await new Promise(resolve => setTimeout(resolve, 1000));
                           }
                       }
                       
                       this.showNotification(`✅ Executed ${executed} signals successfully!`, 'success');
                       btn.innerHTML = '<i data-lucide="check" class="w-4 h-4 inline mr-2"></i>Completed!';
                       
                       setTimeout(() => {
                           btn.disabled = false;
                           btn.innerHTML = '<i data-lucide="zap" class="w-4 h-4 inline mr-2"></i>Execute All Signals';
                           if (typeof lucide !== 'undefined') {
                               lucide.createIcons();
                           }
                       }, 3000);
                       
                   } catch (error) {
                       this.showNotification('❌ Execution failed: ' + error.message, 'error');
                       btn.disabled = false;
                       btn.innerHTML = '<i data-lucide="zap" class="w-4 h-4 inline mr-2"></i>Execute All Signals';
                   }
                   
                   if (typeof lucide !== 'undefined') {
                       lucide.createIcons();
                   }
               }
           }

           showNotification(message, type = 'info') {
               console.log(`${type.toUpperCase()}: ${message}`);
               
               const notification = document.createElement('div');
               notification.className = `notification ${type}`;
               notification.textContent = message;
               
               document.body.appendChild(notification);
               
               setTimeout(() => {
                   if (notification.parentNode) {
                       notification.parentNode.removeChild(notification);
                   }
               }, 5000);
           }

           startRealtimeUpdates() {
               setInterval(() => {
                   // Update portfolio value
                   const portfolioEl = document.getElementById('portfolio-value');
                   if (portfolioEl) {
                       let currentValue = parseFloat(portfolioEl.textContent.replace(/[$,]/g, ''));
                       const change = (Math.random() - 0.4) * 500;
                       currentValue += change;
                       portfolioEl.textContent = `${currentValue.toLocaleString(undefined, {
                           minimumFractionDigits: 2,
                           maximumFractionDigits: 2
                       })}`;
                   }

                   // Update AI processing count
                   const processingEl = document.getElementById('ai-processing-count');
                   if (processingEl) {
                       const rate = (10.8 + Math.random() * 1.4).toFixed(1);
                       processingEl.textContent = `${rate}k/sec`;
                   }

                   // Update AI confidence
                   const confidenceEl = document.getElementById('ai-confidence');
                   if (confidenceEl) {
                       const confidence = (94.5 + Math.random() * 4.5).toFixed(1);
                       confidenceEl.textContent = `${confidence}%`;
                   }
               }, 3000);
           }
       }

       // Initialize when DOM is loaded
       document.addEventListener('DOMContentLoaded', () => {
           window.hyperMindApp = new HyperMindApp();
           window.hyperMindApp.init();

           // Initialize Lucide icons
           if (typeof lucide !== 'undefined') {
               lucide.createIcons();
           }

           console.log('🔥 HyperMind AI Web3 Integration Loaded!');
       });
   </script>
   <script src="../components/web3-config.js"></script>
</body>
</html>
